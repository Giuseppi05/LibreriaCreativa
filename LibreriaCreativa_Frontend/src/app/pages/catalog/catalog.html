<div class="bg-light">
  <div class="container-fluid">
    <div class="row">
      <div class="col-lg-3 col-md-4 p-0">
        <app-catalog-filter
          [selectedFilters]="filters"
          (filtersChange)="onFiltersChange($event)"
        />
      </div>

      <!-- Contenido Principal -->
      <div class="col-lg-9 col-md-8 p-0">
        <div class="p-4">
          <!-- Barra de búsqueda -->
          <div class="row mb-4">
            <app-searchbar
              [query]="currentSearch"
              (search)="onSearch($event)"
            />
          </div>

          <!-- Header del catálogo -->
          <div
            class="d-flex flex-column flex-md-row justify-content-md-between align-items-start align-items-md-center mb-4 gap-2"
          >
            <div>
              <h4 class="color-main-text fw-bold mb-1">
                <i class="fas fa-book me-2"></i>Catálogo de Productos
              </h4>
              <p class="text-muted mb-0" *ngIf="totalElementos > 0">
                Mostrando {{ inicio }} - {{ fin }} de {{ totalElementos }}
                productos
              </p>
            </div>
            <div>
              <select
                class="form-select w-auto"
                [value]="currentSort"
                (change)="onSortChange($event)"
              >
                <option value="default">Ordenar</option>
                <option value="name">Nombre A-Z</option>
                <option value="name-desc">Nombre Z-A</option>
                <option value="price">Precio: Menor a Mayor</option>
                <option value="price-desc">Precio: Mayor a Menor</option>
              </select>
            </div>
          </div>

          <!-- Grid de productos -->
          <div class="row g-4 mb-3">
            <ng-container *ngIf="products.length > 0; else sinProductos">
              <div
                class="col-xl-3 col-lg-4 col-md-6 col-sm-6"
                *ngFor="let producto of products"
              >
                <app-product-card [producto]="producto" />
              </div>
            </ng-container>

            <ng-template #sinProductos>
              <div
                class="alert alert-warning text-center d-flex align-items-center justify-content-center gap-2"
                role="alert"
              >
                <i class="fas fa-box-open fa-lg text-warning"></i>
                <span class="m-0">No hay productos para mostrar.</span>
              </div>
            </ng-template>
          </div>

          <!-- Paginación -->
          <nav *ngIf="totalPaginas > 1" aria-label="Page navigation">
            <ul
              class="pagination pagination-custom justify-content-center mt-4"
            >
              <!-- Botón Anterior -->
              <li class="page-item" [class.disabled]="paginaActual === 0">
                <button
                  class="page-link"
                  (click)="cargarProductos(paginaActual - 1)"
                  [disabled]="paginaActual === 0"
                  aria-label="Anterior"
                >
                  <span aria-hidden="true">&laquo;</span>
                </button>
              </li>

              <!-- Botones de páginas -->
              <li
                class="page-item"
                *ngFor="let i of paginas"
                [class.active]="i === paginaActual"
              >
                <button class="page-link" (click)="cargarProductos(i)">
                  {{ i + 1 }}
                </button>
              </li>

              <!-- Botón Siguiente -->
              <li
                class="page-item"
                [class.disabled]="paginaActual + 1 >= totalPaginas"
              >
                <button
                  class="page-link"
                  (click)="cargarProductos(paginaActual + 1)"
                  [disabled]="paginaActual + 1 >= totalPaginas"
                  aria-label="Siguiente"
                >
                  <span aria-hidden="true">&raquo;</span>
                </button>
              </li>
            </ul>
          </nav>

          <!-- Info de página -->
          <div class="text-center text-muted small" *ngIf="totalElementos > 0">
            Mostrando {{ elementosEnPagina }} de {{ totalElementos }} productos.
            Página {{ paginaActual + 1 }} de {{ totalPaginas }}.
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
